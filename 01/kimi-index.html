<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>Cesium ä¸‰ç»´ç®¡çº¿ç³»ç»Ÿ - ä¸“ä¸šç‰ˆ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- å›¾æ ‡å’Œå­—ä½“ -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --theme: #007acc;
        --theme-hover: #005a9e;
        --theme-light: #e6f3ff;
        --bg: #0a0a0a;
        --bg-secondary: #1a1a1a;
        --panel: #1e1e1e;
        --panel-hover: #2a2a2a;
        --text: #ffffff;
        --text-secondary: #b0b0b0;
        --text-muted: #808080;
        --border: #333333;
        --border-light: #404040;
        --success: #00d4aa;
        --warning: #ffb800;
        --error: #ff4757;
        --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.4);
        --radius: 8px;
        --radius-sm: 4px;
        --radius-lg: 12px;
      }
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: "Inter", "Segoe UI", Roboto, sans-serif;
        background: linear-gradient(
          135deg,
          var(--bg) 0%,
          var(--bg-secondary) 100%
        );
        color: var(--text);
        overflow: hidden;
        font-weight: 400;
        line-height: 1.5;
      }
      /* æ»šåŠ¨æ¡æ ·å¼ */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: var(--bg);
      }
      ::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 3px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: var(--border-light);
      }
      #app {
        display: grid;
        height: 100vh;
        grid-template-areas:
          "header header"
          "left   main"
          "footer footer";
        grid-template-columns: 320px 1fr;
        grid-template-rows: 60px 1fr 36px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }
      #app.collapse-left {
        grid-template-columns: 64px 1fr;
      }
      #app.collapse-right {
        grid-template-columns: 320px 1fr;
      }
      #app.collapse-both {
        grid-template-columns: 64px 1fr;
      }
      /* é¡¶éƒ¨æ  */
      .header {
        grid-area: header;
        background: linear-gradient(
          135deg,
          var(--panel) 0%,
          var(--panel-hover) 100%
        );
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        border-bottom: 1px solid var(--border);
        box-shadow: var(--shadow);
        backdrop-filter: blur(10px);
        position: relative;
        z-index: 100;
      }
      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--theme),
          transparent
        );
      }
      .header .logo {
        font-size: 20px;
        font-weight: 700;
        letter-spacing: 1px;
        background: linear-gradient(135deg, var(--theme), #00d4aa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .header .logo::before {
        content: "ğŸŒ";
        font-size: 24px;
        filter: grayscale(0);
      }
      .header .toolbar {
        display: flex;
        align-items: center;
        gap: 4px;
        background: var(--bg);
        padding: 4px;
        border-radius: var(--radius);
        border: 1px solid var(--border);
      }
      .header .actions {
        display: flex;
        gap: 4px;
      }
      .header .btn {
        background: transparent;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        padding: 8px;
        border-radius: var(--radius-sm);
        transition: all 0.2s ease;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 36px;
        height: 36px;
      }
      .header .btn:hover {
        background: var(--panel-hover);
        color: var(--text);
        transform: translateY(-1px);
      }
      .header .btn.active {
        background: var(--theme);
        color: white;
        box-shadow: 0 2px 8px rgba(0, 122, 204, 0.3);
      }
      .header .btn-group {
        display: flex;
        gap: 2px;
        background: var(--bg);
        padding: 2px;
        border-radius: var(--radius);
        border: 1px solid var(--border);
      }
      /* å·¦ä¾§å·¥å…·ç®± */
      .left-panel {
        grid-area: left;
        background: linear-gradient(
          180deg,
          var(--panel) 0%,
          var(--bg-secondary) 100%
        );
        border-right: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow);
        position: relative;
      }
      .left-panel::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        width: 1px;
        height: 100%;
        background: linear-gradient(
          180deg,
          transparent,
          var(--theme),
          transparent
        );
      }
      .left-panel .tabs {
        display: flex;
        border-bottom: 1px solid var(--border);
        background: var(--bg);
        position: relative;
      }
      .left-panel .tab {
        flex: 1;
        padding: 12px 8px;
        text-align: center;
        cursor: pointer;
        opacity: 0.7;
        transition: all 0.2s ease;
        position: relative;
        font-weight: 500;
        font-size: 14px;
        color: var(--text-secondary);
      }
      .left-panel .tab:hover {
        opacity: 1;
        background: var(--panel-hover);
      }
      .left-panel .tab.active {
        opacity: 1;
        color: var(--text);
        background: var(--panel);
      }
      .left-panel .tab.active::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 40px;
        height: 3px;
        background: linear-gradient(90deg, var(--theme), #00d4aa);
        border-radius: 2px;
      }
      .left-panel .content {
        flex: 1;
        overflow-y: auto;
        padding: 16px;
        background: var(--panel);
      }
      .section {
        margin-bottom: 24px;
      }
      .section-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--text);
        margin-bottom: 12px;
        padding-bottom: 8px;
        border-bottom: 1px solid var(--border);
        position: relative;
      }
      .section-title::before {
        content: "";
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 30px;
        height: 2px;
        background: linear-gradient(90deg, var(--theme), #00d4aa);
        border-radius: 1px;
      }
      .layer-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 12px;
        margin-bottom: 4px;
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        transition: all 0.2s ease;
        cursor: pointer;
      }
      .layer-item:hover {
        background: var(--panel-hover);
        border-color: var(--border-light);
        transform: translateX(2px);
      }
      .layer-item .label {
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
      }
      .layer-item .checkbox {
        width: 18px;
        height: 18px;
        accent-color: var(--theme);
        cursor: pointer;
      }
      .layer-item .slider {
        width: 80px;
        height: 4px;
        background: var(--border);
        border-radius: 2px;
        outline: none;
        cursor: pointer;
        appearance: none;
        -webkit-appearance: none;
      }
      .layer-item .slider::-webkit-slider-thumb {
        appearance: none;
        -webkit-appearance: none;
        width: 16px;
        height: 16px;
        background: var(--theme);
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0, 122, 204, 0.3);
      }
      .layer-item .slider::-moz-range-thumb {
        width: 16px;
        height: 16px;
        background: var(--theme);
        border-radius: 50%;
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 6px rgba(0, 122, 204, 0.3);
      }
      /* ä¸»è§†å›¾ */
      .main {
        grid-area: main;
        position: relative;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #cesiumContainer {
        width: 100%;
        height: 100%;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* åœ°çƒå ä½ç¬¦ */
      .earth-placeholder {
        width: 400px;
        height: 400px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          #1e3c72 0%,
          #2a5298 50%,
          #1e3c72 100%
        );
        position: relative;
        box-shadow: 0 0 50px rgba(0, 122, 204, 0.3),
          inset -20px -20px 50px rgba(0, 0, 0, 0.3),
          inset 20px 20px 50px rgba(255, 255, 255, 0.1);
        animation: rotate 20s linear infinite;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .earth-placeholder:hover {
        transform: scale(1.05);
      }

      .earth-placeholder::before {
        content: "";
        position: absolute;
        top: 20%;
        left: 20%;
        width: 60%;
        height: 60%;
        border-radius: 50%;
        background: linear-gradient(
          45deg,
          rgba(0, 150, 0, 0.3) 0%,
          rgba(0, 200, 0, 0.2) 25%,
          rgba(0, 100, 0, 0.4) 50%,
          rgba(0, 150, 0, 0.3) 75%,
          rgba(0, 200, 0, 0.2) 100%
        );
        animation: rotate 15s linear infinite reverse;
      }

      .earth-placeholder::after {
        content: "";
        position: absolute;
        top: 30%;
        left: 10%;
        width: 80%;
        height: 40%;
        border-radius: 50%;
        background: linear-gradient(
          30deg,
          rgba(0, 100, 0, 0.2) 0%,
          rgba(0, 150, 0, 0.3) 30%,
          rgba(0, 200, 0, 0.1) 60%,
          rgba(0, 100, 0, 0.4) 100%
        );
        animation: rotate 12s linear infinite;
      }

      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      .earth-info {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 14px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .map-overlay {
        position: absolute;
        top: 20px;
        left: 20px;
        right: 20px;
        z-index: 10;
        pointer-events: none;
      }
      .map-overlay > * {
        pointer-events: auto;
      }
      .coordinate-display {
        background: rgba(0, 0, 0, 0.8);
        color: var(--text);
        padding: 8px 12px;
        border-radius: var(--radius);
        font-family: "Courier New", monospace;
        font-size: 12px;
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
      }
      .toolbar-overlay {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        z-index: 10;
      }
      .toolbar-btn {
        width: 40px;
        height: 40px;
        background: rgba(0, 0, 0, 0.8);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        color: var(--text);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        backdrop-filter: blur(10px);
        box-shadow: var(--shadow);
      }
      .toolbar-btn:hover {
        background: var(--theme);
        transform: scale(1.05);
      }
      .toolbar-btn.active {
        background: var(--theme);
        box-shadow: 0 0 20px rgba(0, 122, 204, 0.5);
      }
      /* å³ä¾§ä¿¡æ¯é¢æ¿ */
      .right-panel {
        position: absolute;
        right: 0;
        top: 0;
        bottom: 0;
        width: 360px;
        background: linear-gradient(
          180deg,
          var(--panel) 0%,
          var(--bg-secondary) 100%
        );
        border-left: 1px solid var(--border);
        transform: translateX(100%);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        flex-direction: column;
        box-shadow: var(--shadow-lg);
        backdrop-filter: blur(20px);
        z-index: 20;
      }
      .right-panel.open {
        transform: translateX(0);
      }
      .right-panel::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 1px;
        height: 100%;
        background: linear-gradient(
          180deg,
          transparent,
          var(--theme),
          transparent
        );
      }
      .right-panel .head {
        padding: 16px 20px;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--bg);
      }
      .right-panel .head h3 {
        font-size: 18px;
        font-weight: 600;
        color: var(--text);
        margin: 0;
      }
      .right-panel .body {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        background: var(--panel);
      }
      .property-group {
        margin-bottom: 20px;
      }
      .property-group h4 {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .property-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid var(--border);
      }
      .property-item:last-child {
        border-bottom: none;
      }
      .property-label {
        color: var(--text-secondary);
        font-size: 14px;
      }
      .property-value {
        color: var(--text);
        font-weight: 500;
        font-family: "Courier New", monospace;
        font-size: 13px;
      }
      /* åº•éƒ¨çŠ¶æ€æ  */
      .footer {
        grid-area: footer;
        background: linear-gradient(
          135deg,
          var(--panel) 0%,
          var(--bg-secondary) 100%
        );
        border-top: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        font-size: 12px;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
        position: relative;
      }
      .footer::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--theme),
          transparent
        );
      }
      .status-info {
        display: flex;
        align-items: center;
        gap: 20px;
        color: var(--text-secondary);
      }
      .status-item {
        display: flex;
        align-items: center;
        gap: 6px;
      }
      .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--success);
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      .progress-bar {
        width: 200px;
        height: 4px;
        background: var(--border);
        border-radius: 2px;
        overflow: hidden;
      }
      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--theme), #00d4aa);
        width: 0%;
        transition: width 0.3s ease;
      }
      /* åŠ è½½åŠ¨ç”» */
      .loading {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--bg);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease;
      }
      .loading.hidden {
        opacity: 0;
        pointer-events: none;
      }
      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 3px solid var(--border);
        border-top: 3px solid var(--theme);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      .loading-text {
        color: var(--text-secondary);
        font-size: 14px;
        font-weight: 500;
      }
      /* å·¥å…·æç¤º */
      .tooltip {
        position: absolute;
        background: rgba(0, 0, 0, 0.9);
        color: var(--text);
        padding: 8px 12px;
        border-radius: var(--radius-sm);
        font-size: 12px;
        pointer-events: none;
        z-index: 1000;
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
        opacity: 0;
        transform: translateY(5px);
        transition: all 0.2s ease;
      }
      .tooltip.show {
        opacity: 1;
        transform: translateY(0);
      }
      /* å“åº”å¼ */
      @media (max-width: 768px) {
        #app {
          grid-template-areas:
            "header"
            "main"
            "footer";
          grid-template-columns: 1fr;
          grid-template-rows: 60px 1fr 36px;
        }
        .left-panel {
          position: absolute;
          left: 0;
          top: 60px;
          bottom: 36px;
          z-index: 10;
          transform: translateX(-100%);
          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          width: 280px;
        }
        .left-panel.open {
          transform: translateX(0);
        }
        .right-panel {
          width: 100%;
        }
        .header .toolbar {
          display: none;
        }
        .toolbar-overlay {
          top: 10px;
          right: 10px;
        }
        .coordinate-display {
          font-size: 10px;
          padding: 6px 8px;
        }
      }
      @media (max-width: 480px) {
        .left-panel {
          width: 100%;
        }
        .right-panel {
          width: 100%;
        }
        .header {
          padding: 0 12px;
        }
        .header .logo {
          font-size: 16px;
        }
      }
    </style>
    <base target="_blank" />
  </head>
  <body>
    <!-- åŠ è½½å±å¹• -->
    <div class="loading" :class="{ hidden: !loading }">
      <div class="loading-spinner"></div>
      <div class="loading-text">æ­£åœ¨åˆå§‹åŒ–ä¸‰ç»´åœºæ™¯...</div>
    </div>

    <div
      id="app"
      :class="{ 
      'collapse-left': leftCollapsed, 
      'collapse-right': rightCollapsed,
      'collapse-both': leftCollapsed && rightCollapsed 
    }"
    >
      <!-- é¡¶éƒ¨æ  -->
      <header class="header">
        <div class="logo">Cesium ä¸‰ç»´ç®¡çº¿ç³»ç»Ÿ</div>

        <!-- å·¥å…·æ  -->
        <div class="toolbar">
          <div class="btn-group">
            <button
              class="btn"
              :class="{ active: activeTool === 'select' }"
              @click="setActiveTool('select')"
              title="é€‰æ‹©å·¥å…·"
            >
              <span class="material-symbols-outlined">touch_app</span>
            </button>
            <button
              class="btn"
              :class="{ active: activeTool === 'pan' }"
              @click="setActiveTool('pan')"
              title="å¹³ç§»"
            >
              <span class="material-symbols-outlined">pan_tool</span>
            </button>
            <button
              class="btn"
              :class="{ active: activeTool === 'measure' }"
              @click="setActiveTool('measure')"
              title="æµ‹é‡"
            >
              <span class="material-symbols-outlined">straighten</span>
            </button>
            <button
              class="btn"
              :class="{ active: activeTool === 'draw' }"
              @click="setActiveTool('draw')"
              title="ç»˜åˆ¶"
            >
              <span class="material-symbols-outlined">edit</span>
            </button>
          </div>
        </div>

        <div class="actions">
          <button class="btn" @click="toggleLeft" title="ä¾§è¾¹æ ">
            <span class="material-symbols-outlined">menu</span>
          </button>
          <button class="btn" @click="toggleRight" title="å±æ€§é¢æ¿">
            <span class="material-symbols-outlined">info</span>
          </button>
          <button class="btn" @click="toggleTheme" title="ä¸»é¢˜åˆ‡æ¢">
            <span class="material-symbols-outlined">palette</span>
          </button>
          <button class="btn" title="è®¾ç½®">
            <span class="material-symbols-outlined">settings</span>
          </button>
          <button class="btn" title="å¸®åŠ©">
            <span class="material-symbols-outlined">help_outline</span>
          </button>
        </div>
      </header>

      <!-- å·¦ä¾§å·¥å…·ç®± -->
      <aside class="left-panel" :class="{ open: leftOpen }">
        <div class="tabs">
          <div
            class="tab"
            :class="{ active: activeTab === 'layers' }"
            @click="setActiveTab('layers')"
          >
            å›¾å±‚
          </div>
          <div
            class="tab"
            :class="{ active: activeTab === 'tools' }"
            @click="setActiveTab('tools')"
          >
            å·¥å…·
          </div>
          <div
            class="tab"
            :class="{ active: activeTab === 'analysis' }"
            @click="setActiveTab('analysis')"
          >
            åˆ†æ
          </div>
        </div>
        <div class="content">
          <!-- å›¾å±‚ç®¡ç† -->
          <div v-if="activeTab === 'layers'">
            <section class="section">
              <h4 class="section-title">3D Tiles</h4>
              <div
                class="layer-item"
                v-for="layer in layers.tiles"
                :key="layer.id"
              >
                <div class="label">
                  <input
                    type="checkbox"
                    class="checkbox"
                    v-model="layer.visible"
                    @change="toggleLayer(layer)"
                  />
                  <span>{{ layer.name }}</span>
                </div>
                <input
                  type="range"
                  class="slider"
                  min="0"
                  max="100"
                  v-model="layer.opacity"
                  @input="updateLayerOpacity(layer)"
                />
              </div>
            </section>

            <section class="section">
              <h4 class="section-title">ä¼ æ„Ÿå™¨ç½‘ç»œ</h4>
              <div
                class="layer-item"
                v-for="sensor in layers.sensors"
                :key="sensor.id"
              >
                <div class="label">
                  <input
                    type="checkbox"
                    class="checkbox"
                    v-model="sensor.visible"
                    @change="toggleLayer(sensor)"
                  />
                  <span>{{ sensor.name }}</span>
                </div>
                <div
                  class="status-indicator"
                  :style="{ background: sensor.status === 'online' ? 'var(--success)' : 'var(--error)' }"
                ></div>
              </div>
            </section>

            <section class="section">
              <h4 class="section-title">åœ°å½¢æ•°æ®</h4>
              <div
                class="layer-item"
                v-for="terrain in layers.terrain"
                :key="terrain.id"
              >
                <div class="label">
                  <input
                    type="checkbox"
                    class="checkbox"
                    v-model="terrain.visible"
                    @change="toggleLayer(terrain)"
                  />
                  <span>{{ terrain.name }}</span>
                </div>
                <input
                  type="range"
                  class="slider"
                  min="0"
                  max="100"
                  v-model="terrain.opacity"
                  @input="updateLayerOpacity(terrain)"
                />
              </div>
            </section>
          </div>

          <!-- å·¥å…·é¢æ¿ -->
          <div v-if="activeTab === 'tools'">
            <section class="section">
              <h4 class="section-title">æµ‹é‡å·¥å…·</h4>
              <div class="layer-item" @click="startMeasurement('distance')">
                <div class="label">
                  <span class="material-symbols-outlined">straighten</span>
                  <span>è·ç¦»æµ‹é‡</span>
                </div>
              </div>
              <div class="layer-item" @click="startMeasurement('area')">
                <div class="label">
                  <span class="material-symbols-outlined">crop_square</span>
                  <span>é¢ç§¯æµ‹é‡</span>
                </div>
              </div>
              <div class="layer-item" @click="startMeasurement('height')">
                <div class="label">
                  <span class="material-symbols-outlined">height</span>
                  <span>é«˜åº¦æµ‹é‡</span>
                </div>
              </div>
            </section>

            <section class="section">
              <h4 class="section-title">ç»˜åˆ¶å·¥å…·</h4>
              <div class="layer-item" @click="startDrawing('point')">
                <div class="label">
                  <span class="material-symbols-outlined"
                    >radio_button_unchecked</span
                  >
                  <span>ç»˜åˆ¶ç‚¹</span>
                </div>
              </div>
              <div class="layer-item" @click="startDrawing('line')">
                <div class="label">
                  <span class="material-symbols-outlined">timeline</span>
                  <span>ç»˜åˆ¶çº¿</span>
                </div>
              </div>
              <div class="layer-item" @click="startDrawing('polygon')">
                <div class="label">
                  <span class="material-symbols-outlined">shape_line</span>
                  <span>ç»˜åˆ¶é¢</span>
                </div>
              </div>
            </section>
          </div>

          <!-- åˆ†æé¢æ¿ -->
          <div v-if="activeTab === 'analysis'">
            <section class="section">
              <h4 class="section-title">ç©ºé—´åˆ†æ</h4>
              <div class="layer-item" @click="performAnalysis('visibility')">
                <div class="label">
                  <span class="material-symbols-outlined">visibility</span>
                  <span>å¯è§†æ€§åˆ†æ</span>
                </div>
              </div>
              <div class="layer-item" @click="performAnalysis('buffer')">
                <div class="label">
                  <span class="material-symbols-outlined">my_location</span>
                  <span>ç¼“å†²åŒºåˆ†æ</span>
                </div>
              </div>
              <div class="layer-item" @click="performAnalysis('intersection')">
                <div class="label">
                  <span class="material-symbols-outlined">merge</span>
                  <span>ç›¸äº¤åˆ†æ</span>
                </div>
              </div>
            </section>

            <section class="section">
              <h4 class="section-title">ç»Ÿè®¡ä¿¡æ¯</h4>
              <div class="property-item">
                <span class="property-label">å®ä½“æ•°é‡</span>
                <span class="property-value">{{ statistics.entityCount }}</span>
              </div>
              <div class="property-item">
                <span class="property-label">å›¾å±‚æ•°é‡</span>
                <span class="property-value">{{ statistics.layerCount }}</span>
              </div>
              <div class="property-item">
                <span class="property-label">åœºæ™¯å¤§å°</span>
                <span class="property-value"
                  >{{ statistics.sceneSize }} MB</span
                >
              </div>
            </section>
          </div>
        </div>
      </aside>

      <!-- ä¸»è§†å›¾ -->
      <main class="main">
        <div id="cesiumContainer">
          <!-- åœ°çƒå ä½ç¬¦ -->
          <div class="earth-placeholder" @click="onEarthClick">
            <div class="earth-info">
              <div>ğŸŒ ä¸‰ç»´åœ°çƒè§†å›¾</div>
              <div style="font-size: 12px; opacity: 0.8">ç‚¹å‡»äº¤äº’</div>
            </div>
          </div>
        </div>

        <!-- åœ°å›¾è¦†ç›–å±‚ -->
        <div class="map-overlay">
          <div class="coordinate-display">
            <div>ç»åº¦: {{ coordinates.longitude.toFixed(6) }}Â°</div>
            <div>çº¬åº¦: {{ coordinates.latitude.toFixed(6) }}Â°</div>
            <div>é«˜ç¨‹: {{ coordinates.height.toFixed(2) }} m</div>
          </div>
        </div>

        <!-- å·¥å…·æ è¦†ç›–å±‚ -->
        <div class="toolbar-overlay">
          <button
            class="toolbar-btn"
            :class="{ active: activeTool === 'home' }"
            @click="goHome"
            title="å›åˆ°é¦–é¡µ"
          >
            <span class="material-symbols-outlined">home</span>
          </button>
          <button
            class="toolbar-btn"
            :class="{ active: activeTool === 'fullscreen' }"
            @click="toggleFullscreen"
            title="å…¨å±"
          >
            <span class="material-symbols-outlined">fullscreen</span>
          </button>
          <button class="toolbar-btn" @click="captureScreenshot" title="æˆªå›¾">
            <span class="material-symbols-outlined">camera_alt</span>
          </button>
          <button class="toolbar-btn" @click="resetView" title="é‡ç½®è§†å›¾">
            <span class="material-symbols-outlined">refresh</span>
          </button>
        </div>

        <!-- å³ä¾§ä¿¡æ¯é¢æ¿ -->
        <div class="right-panel" :class="{ open: rightOpen }">
          <div class="head">
            <h3>å±æ€§ä¿¡æ¯</h3>
            <button class="btn" @click="rightOpen=false">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>
          <div class="body">
            <div v-if="selectedEntity">
              <div class="property-group">
                <h4>åŸºæœ¬ä¿¡æ¯</h4>
                <div class="property-item">
                  <span class="property-label">åç§°</span>
                  <span class="property-value"
                    >{{ selectedEntity.name || 'æœªå‘½å' }}</span
                  >
                </div>
                <div class="property-item">
                  <span class="property-label">ç±»å‹</span>
                  <span class="property-value"
                    >{{ selectedEntity.type || 'æœªçŸ¥' }}</span
                  >
                </div>
                <div class="property-item">
                  <span class="property-label">ID</span>
                  <span class="property-value">{{ selectedEntity.id }}</span>
                </div>
              </div>

              <div class="property-group">
                <h4>ä½ç½®ä¿¡æ¯</h4>
                <div class="property-item">
                  <span class="property-label">ç»åº¦</span>
                  <span class="property-value"
                    >{{ selectedEntity.position?.longitude?.toFixed(6) || 'N/A'
                    }}Â°</span
                  >
                </div>
                <div class="property-item">
                  <span class="property-label">çº¬åº¦</span>
                  <span class="property-value"
                    >{{ selectedEntity.position?.latitude?.toFixed(6) || 'N/A'
                    }}Â°</span
                  >
                </div>
                <div class="property-item">
                  <span class="property-label">é«˜ç¨‹</span>
                  <span class="property-value"
                    >{{ selectedEntity.position?.height?.toFixed(2) || 'N/A' }}
                    m</span
                  >
                </div>
              </div>

              <div class="property-group" v-if="selectedEntity.properties">
                <h4>å±æ€§æ•°æ®</h4>
                <div
                  class="property-item"
                  v-for="(value, key) in selectedEntity.properties"
                  :key="key"
                >
                  <span class="property-label">{{ key }}</span>
                  <span class="property-value">{{ value }}</span>
                </div>
              </div>
            </div>
            <div v-else>
              <p
                style="
                  color: var(--text-muted);
                  text-align: center;
                  margin-top: 40px;
                "
              >
                ç‚¹å‡»åœ°å›¾ä¸Šçš„å®ä½“æŸ¥çœ‹è¯¦ç»†å±æ€§
              </p>
            </div>
          </div>
        </div>
      </main>

      <!-- åº•éƒ¨çŠ¶æ€æ  -->
      <footer class="footer">
        <div class="status-info">
          <div class="status-item">
            <div class="status-indicator"></div>
            <span>ç³»ç»ŸçŠ¶æ€: åœ¨çº¿</span>
          </div>
          <div class="status-item">
            <span>FPS: {{ performance.fps }}</span>
          </div>
          <div class="status-item">
            <span>å†…å­˜: {{ performance.memory }} MB</span>
          </div>
        </div>
        <div class="progress-bar">
          <div
            class="progress-fill"
            :style="{ width: loadingProgress + '%' }"
          ></div>
        </div>
        <div class="status-info">
          <span>{{ statusMessage }}</span>
        </div>
      </footer>
    </div>

    <!-- å·¥å…·æç¤º -->
    <div class="tooltip" ref="tooltip"></div>

    <!-- ä»…æ¼”ç¤ºç”¨ï¼šVue3 CDN ç‰ˆï¼Œå®é™…é¡¹ç›®è¯·æ”¹ import -->
    <script type="module">
      import {
        createApp,
        reactive,
        ref,
        onMounted,
        onUnmounted,
      } from "https://cdn.jsdelivr.net/npm/vue@3/dist/vue.esm-browser.js";

      const app = createApp({
        setup() {
          const state = reactive({
            // ç•Œé¢çŠ¶æ€
            leftCollapsed: false,
            rightCollapsed: false,
            leftOpen: true,
            rightOpen: false,
            loading: true,
            loadingProgress: 0,

            // å·¥å…·çŠ¶æ€
            activeTool: "select",
            activeTab: "layers",

            // åæ ‡ä¿¡æ¯
            coordinates: {
              longitude: 116.391,
              latitude: 39.907,
              height: 42,
            },

            // æ€§èƒ½ä¿¡æ¯
            performance: {
              fps: 60,
              memory: 128,
            },

            // çŠ¶æ€ä¿¡æ¯
            statusMessage: "å°±ç»ª",

            // é€‰ä¸­çš„å®ä½“
            selectedEntity: null,

            // å›¾å±‚æ•°æ®
            layers: {
              tiles: [
                { id: 1, name: "ç®¡çº¿åˆ‡ç‰‡", visible: true, opacity: 100 },
                { id: 2, name: "å»ºç­‘åˆ‡ç‰‡", visible: false, opacity: 80 },
                { id: 3, name: "é“è·¯åˆ‡ç‰‡", visible: true, opacity: 60 },
              ],
              sensors: [
                { id: 1, name: "æ¸©åº¦ä¼ æ„Ÿå™¨", visible: true, status: "online" },
                {
                  id: 2,
                  name: "å‹åŠ›ä¼ æ„Ÿå™¨",
                  visible: false,
                  status: "offline",
                },
                { id: 3, name: "æµé‡ä¼ æ„Ÿå™¨", visible: true, status: "online" },
              ],
              terrain: [
                { id: 1, name: "DEMåœ°å½¢", visible: true, opacity: 100 },
                { id: 2, name: "å«æ˜Ÿå½±åƒ", visible: true, opacity: 90 },
              ],
            },

            // ç»Ÿè®¡ä¿¡æ¯
            statistics: {
              entityCount: 156,
              layerCount: 8,
              sceneSize: 45.2,
            },
          });

          // å·¥å…·æç¤ºå¼•ç”¨
          const tooltip = ref(null);

          // ç•Œé¢æ§åˆ¶æ–¹æ³•
          const toggleLeft = () => {
            if (window.innerWidth <= 768) {
              state.leftOpen = !state.leftOpen;
            } else {
              state.leftCollapsed = !state.leftCollapsed;
            }
          };

          const toggleRight = () => {
            state.rightOpen = !state.rightOpen;
          };

          const toggleTheme = () => {
            // ä¸»é¢˜åˆ‡æ¢é€»è¾‘
            console.log("åˆ‡æ¢ä¸»é¢˜");
          };

          // æ ‡ç­¾é¡µåˆ‡æ¢
          const setActiveTab = (tab) => {
            state.activeTab = tab;
          };

          // å·¥å…·åˆ‡æ¢
          const setActiveTool = (tool) => {
            state.activeTool = tool;
            state.statusMessage = `å·²åˆ‡æ¢åˆ°${tool}å·¥å…·`;
          };

          // å›¾å±‚æ§åˆ¶
          const toggleLayer = (layer) => {
            console.log(`åˆ‡æ¢å›¾å±‚: ${layer.name}, å¯è§æ€§: ${layer.visible}`);
          };

          const updateLayerOpacity = (layer) => {
            console.log(
              `æ›´æ–°å›¾å±‚é€æ˜åº¦: ${layer.name}, é€æ˜åº¦: ${layer.opacity}%`
            );
          };

          // æµ‹é‡å·¥å…·
          const startMeasurement = (type) => {
            state.activeTool = "measure";
            state.statusMessage = `å¼€å§‹${type}æµ‹é‡`;
            console.log(`å¼€å§‹${type}æµ‹é‡`);
          };

          // ç»˜åˆ¶å·¥å…·
          const startDrawing = (type) => {
            state.activeTool = "draw";
            state.statusMessage = `å¼€å§‹ç»˜åˆ¶${type}`;
            console.log(`å¼€å§‹ç»˜åˆ¶${type}`);
          };

          // åˆ†æå·¥å…·
          const performAnalysis = (type) => {
            state.statusMessage = `æ‰§è¡Œ${type}åˆ†æ`;
            console.log(`æ‰§è¡Œ${type}åˆ†æ`);
          };

          // åœ°å›¾æ§åˆ¶
          const goHome = () => {
            state.statusMessage = "å›åˆ°é¦–é¡µè§†å›¾";
            console.log("å›åˆ°é¦–é¡µ");
          };

          const toggleFullscreen = () => {
            if (!document.fullscreenElement) {
              document.documentElement.requestFullscreen();
            } else {
              document.exitFullscreen();
            }
          };

          const captureScreenshot = () => {
            state.statusMessage = "æ­£åœ¨æˆªå›¾...";
            console.log("æˆªå›¾åŠŸèƒ½");
          };

          const resetView = () => {
            state.statusMessage = "é‡ç½®è§†å›¾";
            console.log("é‡ç½®è§†å›¾");
          };

          // åœ°çƒç‚¹å‡»äº‹ä»¶
          const onEarthClick = () => {
            state.statusMessage = "åœ°çƒäº¤äº’åŠŸèƒ½";
            console.log("åœ°çƒè¢«ç‚¹å‡»");
            // æ¨¡æ‹Ÿé€‰æ‹©å®ä½“
            state.selectedEntity = {
              id: "earth_001",
              name: "åœ°çƒ",
              type: "æ˜Ÿçƒ",
              position: {
                longitude: 0,
                latitude: 0,
                height: 0,
              },
              properties: {
                åŠå¾„: "6,371 km",
                è´¨é‡: "5.97Ã—10Â²â´ kg",
                ç±»å‹: "ç±»åœ°è¡Œæ˜Ÿ",
                çŠ¶æ€: "æ­£å¸¸",
              },
            };
            state.rightOpen = true;
          };

          // æ€§èƒ½ç›‘æ§
          const updatePerformance = () => {
            state.performance.fps = Math.floor(Math.random() * 20) + 50;
            state.performance.memory = Math.floor(Math.random() * 50) + 100;
          };

          // åæ ‡æ›´æ–°ï¼ˆå·²ç§»è‡³å¤–éƒ¨å¤„ç†ï¼‰
          const updateCoordinates = (longitude, latitude, height) => {
            state.coordinates.longitude = longitude;
            state.coordinates.latitude = latitude;
            state.coordinates.height = height;
          };

          // å·¥å…·æç¤º
          const showTooltip = (element, text) => {
            if (tooltip.value) {
              tooltip.value.textContent = text;
              tooltip.value.classList.add("show");

              const rect = element.getBoundingClientRect();
              tooltip.value.style.left = rect.left + rect.width / 2 + "px";
              tooltip.value.style.top = rect.top - 10 + "px";
            }
          };

          const hideTooltip = () => {
            if (tooltip.value) {
              tooltip.value.classList.remove("show");
            }
          };

          // æ¨¡æ‹ŸåŠ è½½è¿‡ç¨‹
          const simulateLoading = () => {
            const interval = setInterval(() => {
              state.loadingProgress += Math.random() * 10;
              if (state.loadingProgress >= 100) {
                state.loadingProgress = 100;
                state.loading = false;
                clearInterval(interval);
                state.statusMessage = "ç³»ç»Ÿå°±ç»ª";
              }
            }, 200);
          };

          // æ€§èƒ½ç›‘æ§çš„å¼•ç”¨
          let performanceInterval;

          // ç”Ÿå‘½å‘¨æœŸ
          onMounted(() => {
            simulateLoading();

            // æ€§èƒ½ç›‘æ§
            performanceInterval = setInterval(updatePerformance, 1000);

            // æ¨¡æ‹Ÿç‚¹å‡»å®ä½“åæ‰“å¼€å³ä¾§é¢æ¿
            window.addEventListener("message", (e) => {
              if (e.data === "showProps") {
                state.rightOpen = true;
                state.selectedEntity = {
                  id: "entity_001",
                  name: "ç¤ºä¾‹ç®¡çº¿",
                  type: "ç®¡é“",
                  position: {
                    longitude: 116.391,
                    latitude: 39.907,
                    height: 42,
                  },
                  properties: {
                    ç®¡å¾„: "DN800",
                    æè´¨: "é’¢ç®¡",
                    å‹åŠ›: "1.6MPa",
                    çŠ¶æ€: "æ­£å¸¸",
                  },
                };
              }
            });
          });

          onUnmounted(() => {
            if (performanceInterval) {
              clearInterval(performanceInterval);
            }
          });

          return {
            ...state,
            tooltip,
            toggleLeft,
            toggleRight,
            toggleTheme,
            setActiveTab,
            setActiveTool,
            toggleLayer,
            updateLayerOpacity,
            startMeasurement,
            startDrawing,
            performAnalysis,
            goHome,
            toggleFullscreen,
            captureScreenshot,
            resetView,
            onEarthClick,
            showTooltip,
            hideTooltip,
          };
        },
      });

      // æŒ‚è½½åº”ç”¨å¹¶ä¿å­˜å¼•ç”¨
      const mountedApp = app.mount("#app");

      // å°†åº”ç”¨å®ä¾‹ä¿å­˜åˆ°å…¨å±€å˜é‡
      window.vueApp = mountedApp;

      // æ¨¡æ‹Ÿåæ ‡æ›´æ–°ï¼ˆä¸éœ€è¦çœŸå®åœ°å›¾ï¼‰
      setInterval(() => {
        if (window.vueApp && window.vueApp.coordinates) {
          window.vueApp.coordinates.longitude =
            116.391 + (Math.random() - 0.5) * 0.001;
          window.vueApp.coordinates.latitude =
            39.907 + (Math.random() - 0.5) * 0.001;
          window.vueApp.coordinates.height = 42 + (Math.random() - 0.5) * 10;
        }
      }, 1000);
    </script>
  </body>
</html>
